\documentclass[12pt,reqno]{amsart}

\usepackage{amssymb}
\usepackage{amscd}
\usepackage{amsfonts}
%\usepackage{showkeys}
\usepackage{setspace}
\usepackage{version}
\usepackage[noabbrev,capitalize]{cleveref}
\usepackage{geometry}
\usepackage{mathtools}
\usepackage{amsmath}

\geometry{a4paper, margin=1in}
\setlength{\parskip}{5pt}
\setlength{\parindent}{0pt}
\textheight 9in \textwidth 6.5in


%     If your article includes graphics, uncomment this command.
%\usepackage{graphicx}

%     If the article includes commutative diagrams, ...
%\usepackage[cmtip,all]{xy}

\newtheorem{theorem}{Theorem}[section]
\newtheorem{lemma}[theorem]{Lemma}
\newtheorem{proposition}[theorem]{Proposition}
\newtheorem{corollary}[theorem]{Corollary}

\theoremstyle{definition}
\newtheorem{definition}[theorem]{Definition}
\newtheorem{example}[theorem]{Example}
\newtheorem{xca}[theorem]{Exercise}
\newtheorem{question}[theorem]{Question}
\newtheorem{conjecture}[theorem]{Conjecture}
\newtheorem{problem}[theorem]{Problem}

\theoremstyle{remark}
\newtheorem{remark}[theorem]{Remark}


\newsavebox{\proofbox}
\savebox{\proofbox}{\begin{picture}(7,7)  \put(0,0){\framebox(7,7){}}\end{picture}}
\def\boxeq{\tag*{\usebox{\proofbox}}}
\def\diamondeq{\tag*{$\diamond$}}
\newcommand{\md}[1]{\ensuremath{\,(\operatorname{mod}\, #1)}}
\newcommand{\mdsub}[1]{\ensuremath{(\mbox{\scriptsize mod}\, #1)}}
\newcommand{\mdlem}[1]{\ensuremath{(\mbox{\textup{mod}}\, #1)}}
\newcommand{\mdsublem}[1]{\ensuremath{(\mbox{\scriptsize \textup{mod}}\, #1)}}

\renewcommand{\labelenumi}{(\roman{enumi})}


\renewcommand{\leq}{\leqslant}
\renewcommand{\geq}{\geqslant}
\newcommand\SL{\operatorname{SL}}
\newcommand\GL{\operatorname{GL}}
\newcommand\SO{\operatorname{SO}}
\newcommand\Hom{\operatorname{Hom}}
\newcommand\tr{\operatorname{tr}}
\newcommand\id{\operatorname{id}}
\newcommand\im{\operatorname{im}}
\newcommand\Lip{\operatorname{Lip}}
\newcommand\tor{\operatorname{tor}}
\newcommand\sml{\operatorname{sml}}
\newcommand\unf{\operatorname{unf}}
\newcommand\poly{\operatorname{poly}}
\newcommand\disc{\operatorname{disc}}
\def\F{\mathbb{F}}
\def\R{\mathbb{R}}
\def\C{\mathbb{C}}
\def\Z{\mathbb{Z}}
\def\E{\mathbb{E}}
\def\P{\mathbb{P}}
\def\Q{\mathbb{Q}}
\def\N{\mathbb{N}}
\def\T{\mathbb{T}}
\def\cr{\operatorname{cr}}
\def\eps{\varepsilon}


\parskip 1mm

\numberwithin{equation}{section}

\begin{document}

% \title[short text for running head]{full title}
\title[MATH 262A: Discrete Geometry]{MATH 262A: Discrete Geometry Notes}

%    Only \author and \address are required; other information is
%    optional.  Remove any unused author tags.

%    author one information
% \author[short version for running head]{name for top of paper}

\author{Ray Tsai}

\onehalfspace
%    \subjclass is required.
%\subjclass[2000]{Primary }
%    The 2010 edition of the Mathematics Subject Classification is
%    now available.  If you are citing a classification from the
%    new scheme, use the following input coding instead.
%\subjclass[2010]{Primary }

\maketitle

\tableofcontents

\newpage

\section{Sums vs Product}

\begin{definition}
	The \textit{crossing number} of a graph $G$, denoted $\cr(G)$, is the minimum number of crossing pair of edges over all possisble drawings of $G$ in the plane.
\end{definition}

\begin{lemma}[Crossing Lemma]\label{lem:crossing}
	Let $G = (V, E)$ be a graph. If $|E| \geq 4|V|$, then
	\[
		\cr(G) \geq \frac{|E|^3}{64|V|^2}.
	\]
\end{lemma}

\begin{theorem}\label{thm:sumprod}
	Let $A$ be a set of $n$ distinct real numbers. Then $\max\{|A + A|, |A \cdot A|\} = \Omega(n^{5/4})$.
\end{theorem}

\begin{proof}
	Denote $A + A = \{s_1, s_2, \ldots, s_x\}$ and $A \cdot A = \{p_1, p_2, \ldots, p_y\}$. Let $L$ be the set of lines $v = a_i(u - a_j)$ for $a_i, a_j \in A$. Construct the graph $G = (V, E)$ with $V = (A + A) \times (A \cdot A)$ and $\{(s_i, p_i), (s_j, p_j)\} \in E$ if and only if there exists a line $l \in L$ such that $(s_i, p_i)$ and $(s_j, p_j)$ are consecutive points on $l$. Notice that each line passes through at least $n - 1$ points in $V$, so $|E| \geq (n - 1)|L| = \Omega(n^3)$. If $|E| < 4|V|$, then 
	\[
		4|A + A| \cdot |A \cdot A| = 4|V| > |E| = \Omega(n^3).
	\]
	But then either $|A + A| = \Omega(n^{3/2})$ or $|A \cdot A| = \Omega(n^{3/2})$. Thus we may assume $|E| \geq 4|V|$. By the crossing lemma, 
	\[
		\frac{|E|^3}{64|V|^2} \leq \cr(G) \leq |L|^2 \leq n^4.
	\]
	Rearranged, we have
	\[
		|V|^2 \geq \frac{|E|^{3}}{64n^4} = \Omega(n^{5}).
	\]
	The result now follows.
\end{proof}

\newpage

\section{Crossing Lemma}

In this section we prove the Crossing lemma mentioned in the previous section. 


\begin{lemma}
	Let $G = (V, E)$ be a graph. Then $\cr(G) \geq |E| - 3|V|$. 
\end{lemma}

\begin{proof}
	Suppose not. We may assume $|E| \geq 3|V|$, otherwise we are done. Remove edges from each crossing until we have a planar graph. Since $\cr(G) < |E| - 3|V|$, we removed less than $|E| - 3|V|$ edges. But then the planar graph has more than $|E| - (|E| - 3|V|) = 3|V|$ edges, contradicting Euler's theorem. 
\end{proof}

\begin{lemma}[Crossing Lemma]
	Let $G = (V, E)$ be a graph. If $|E| \geq 4|V|$, then
	\[
		\cr(G) \geq \frac{|E|^3}{64|V|^2}.
	\]
\end{lemma}

\begin{proof}
	For any graph $H$, define $X_H = \cr(H) - |E(H)| + 3|V(H)|$. By the crossing lemma we know $X_H \geq 0$. Consider the drawing of $G$ in $\R^2$ with $\cr(G)$ crossings. Let $S \subseteq V$ be a set vertices where each vertex is chosen independently with probability $p \in [0, 1]$. Let $G' = G[S]$ be the induced subgraph on $S$. Then
	\[
		\E[X_{G'}] = \E[\cr(G')] - \E[|E(G')|] + 3\E[|V(G')|] = \E[\cr(G')] - p^2|E| + 3p|V| \geq 0.
	\]
	Let $C_{G'}$ be the number of crossings in the drawing of $G'$ inherited from $G$. Obviously, $\E[\cr(G')] \leq \E[C_{G'}]$. Since each crossing pair has a probability of $p^4$ of being in $G'$, we have $\E[C_{G'}] = p^4\cr(G)$, and thus
	\[
		p^4\cr(G) \geq \E[\cr(G')] \geq p^2|E| - 3p|V|.
	\]
	By setting $p = 4|V|/|E|$, we have
	\[
		\cr(G) \geq \frac{|E|}{p^2} - \frac{3|V|}{p^3} \geq \frac{|E|^3}{64|V|^2}.
	\]
\end{proof}

\newpage

\section{Szemerédi-Trotter Theorem}

\begin{definition}
	Let $P$ be a set of $n$ points and $L$ be a set of $m$ lines in the plane. We call a pair $(p, l)$ \textit{incidence} if $p \in P$, $l \in L$, and $p \in l$. Define $I(P, L)$ as the number of incidences between $P$ and $L$, and define $I(m, n)$ as the maximum number of incidences between any $m$ lines and $n$ points.
\end{definition}

\begin{definition}
	Let $P$ be a set of $n$ points. A line is \textit{generated by} $P$ if it contains at least 2 points from $P$.
\end{definition}

\begin{definition}
	For $k \geq 2$ and a set of points $P$, a line $l$ is $k$-rich if it contains at least $k$ points from $P$.
\end{definition}

\begin{theorem}[Szemerédi-Trotter Theorem]\label{thm:szemeredi-trotter}
	For all $m, n \geq 1$, we have $I(m, n) = O(m^{2/3}n^{2/3} + m + n)$.
\end{theorem}

\begin{proof}
	We will adopt the same strategy as the proof of \cref{thm:sumprod}, which constructs a graph and double counts the number of crossings in it.

	Let $P$ be the set of $n$ points in $\R^2$ and $L$ be the set of $m$ lines in $\R^2$.	Define graph $G = (V, E)$ where $V = P$ and $E$ is the set of consecutive pairs of vertices along some line in $L$. We may assume each line in $L$ contains at least one point from $P$. For $l \in L$, let $|l|$ denote the number of points in $P$ which lies in $l$. Observe that
	\[
		|E| = \sum_{l \in L} |l| - 1 = |I(P, L)| - m.
	\]
	Hence, it suffices to show that $|E| = O(m^{2/3}n^{2/3} + n)$. We may assume $|E| \geq 4|V|$, otherwise we are done. Note that the construction of $G$ gives a natural drawing with points $P$ and lines $P$ in the plane, so we may define $C$ as the number of crossings in this drawing. By the crossing lemma, we have
	\[
		\frac{|E|^3}{64n^2} \leq \cr(G) \leq C \leq \binom{m}{2} = O(m^2).
	\]
	It now follows that
	\[
		|E| = O(n^{2/3}m^{2/3}).
	\]
	This completes the proof.
\end{proof}

% We now give a construction which shows that the Szemerédi-Trotter theorem is tight when $m = n$. Consider $P = \left[\lfloor n^{1/3}\rfloor\right] \times \left[\lfloor n^{2/3}\rfloor\right]$ and $L$ consists of lines $y = ax + b$ where $a \in \left[\lfloor n^{1/3}/4\rfloor\right]$ and $b \in \left[\lfloor n^{2/3}/4\rfloor\right]$. 


\begin{corollary}\label{cor:szemeredi-trotter}
	Let $P$ be a set of $n$ points. Then $P$ generates $O(n^2/k^3 + n/k)$ $k$-rich lines.
\end{corollary}

\begin{proof}
	Let $L_k$ be the set of $k$-rich lines generated by $P$. By the Szemerédi-Trotter theorem, 
	\[
		k|L_k| \leq I(P, L_k) = c(|L_k|^{2/3}n^{2/3} + |L_k| + n),
	\]
	for some constant $c$. We may assume $k \geq 4c$, otherwise we are done as $|L_k| = O(n^2)$. If $n + |L_k| \geq |L_k|^{2/3}n^{2/3}$. Then 
	\[
		k|L_k| \leq 2c(|L_k| + n) = 2cm + 2c|L_k|.
	\]
	Rearranged,
	\[
		|L_k| \leq \frac{2cm}{k - 2c} \leq O(m/k).
	\]
	Now suppose $n + |L_k| < |L_k|^{2/3}n^{2/3}$. Then 
	\[
		k|L_k| \leq 2c|L_k|^{2/3}n^{2/3},
	\]
	and so 
	\[
		|L_k|= O(n^{2}/k^3). 
	\]
\end{proof}

\newpage

\section{The Cutting Lemma}

\begin{lemma}[Cutting Lemma]
	Let $L$ be a set of $m$ lines in $\R^2$ and let $r \in (1, m)$. Then the plane can be subdivied into $t = O(r^2)$ generalized triangles (intersections of three half planes) $\Delta_1, \Delta_2, \ldots, \Delta_t$ such that the interior of each $\Delta_i$ is intersected by at most $m/r$ lines of $L$. 
\end{lemma}

\begin{lemma}
	Let $L$ be a set of $m$ lines in $\R^2$ and let $r \in (1, m)$. Then the plane can be subdivied into $t = O(r^2\log^2 n)$ generalized triangles $\Delta_1, \Delta_2, \ldots, \Delta_t$ such that the interior of each $\Delta_i$ is intersected by at most $m/r$ lines of $L$. 
\end{lemma}

\begin{proof}
	Put $s = 6r\ln m$. Select a random set of lines $S \subset L$ by making $s$ independent random draws with replacement. Consider the line arrangement of $S$. Partition any cell that is not a generalized triangle further by adding diagonals that connect vertices. To this end, $\R^2$ is partitioned into $t$ generalized triangles. Consider a box $B$ that contains all bounded triangles $\Delta_i$. Since each line crosses through $B$ two times and each two consecutive lines around $B$ determine an unbounded triangle, the number of unbounded triangles is at most $2s$. Now consider the bounded triangles. View each intersecting point of two lines in $S$ as a vertex of a graph, and each bounded triangle as a face. Let $V$ denote the set of vertices and $F$ the set of faces. We know that $|V| \leq \binom{s}{2} = O(s^2)$. By Euler's formula, we have
	\[
		3|F| \leq \sum_{f \in F} \deg f = 2|E| = 2(|V| + |F| - 2),
	\]
	and thus 
	\[
		|F| \leq 2|V| - 4 = O(s^2).
	\]
	Hence, we have $t = O(s^2)$. 
	
	We call a (generalized) triangle \textit{horny} if its interior intersects at least $m/r$ lines of $L$. For any horny triangle $T$, the probability that no line in $S$ intersects the interior of $T$ is at most $(1 - 1/r)^s$. Using the inequality $1 - x \leq e^{-x}$, we have $(1 - 1/r)^s \leq e^{-6\ln m} = m^{-6}$. 

	Now call a triangle \textit{interesting} if it can appear in a triangulation for some sample $S \subset L$. Notice that each vertex of an interesting triangle is an intersecting point of two lines in the arrangement of $L$, and thus there are at most $\binom{m}{2}^3 < m^6$ such triangles. 

	But then the expected number of horny $\Delta_i$'s is less than $m^{-6} \cdot m^{6} = 1$. It now follows that there exists a set of $S \subseteq L$ such that each $\Delta_i$ is intersected by at most $m/r$ lines.
\end{proof}

\newpage

\section{An Aliter for the Szemerédi-Trotter Theorem}

\begin{theorem}[Kővári-Sós-Turán Theorem]
	For $s, t \geq 2$, let $G$ be an $m \times n$ bipartite graph that does not contain a complete bipartite graph $K_{s, t}$ where the $s$ vertices are from the part of size $m$. Then,
	\[
		|E(G)| = O(nm^{1 - 1/t} + m) \quad \text{ and } \quad |E(G)| = O(mn^{1 - 1/s} + n).
	\]
\end{theorem}

\begin{proof}
	Let $M, N$ be the two parts of the bipartite graph $G$, with $|M| = m$ and $|N| = n$. Notice that no set of $s$ vertices in $M$ has more than $t - 1$ common neighbors in $N$, so
	\[
		\sum_{v \in M} \binom{d(v)}{t} \leq \binom{n}{t} (s - 1) \leq \frac{sn^t}{t!}.
	\]
	By Jensen's inequality, we have
	\[
		\sum_{v \in M} \binom{d(v)}{t} \geq m\binom{\frac{1}{m}\sum_{v \in M} d(v)}{t} \geq \frac{m(2|E(G)|/m - t)^t}{t!}.
	\]
	The result now follows from the two inequalities.
\end{proof}

\begin{corollary}\label{cor:ks}
	$|I(m, n)| \leq O(n\sqrt{m} + m)$ and $|I(m, n)| \leq O(m\sqrt{n} + n)$.
\end{corollary}

\begin{proof}
	Let $P$ be the set of $n$ points and $L$ be the set of $m$ lines in $\R^2$. Let $G = (P, L)$ be the bipartite graph with parts $P$ and $L$ and $(p, l)$ is an edge if and only if $p \in l$. Since no two points lie on the same line, $G$ is $K_{2, 2}$-free. The resulting bounds now follows from the Kővári-Sós-Turán theorem.
\end{proof}

We give an alternative proof of a case of the Szemerédi-Trotter theorem with $n$ points and $n$ lines, using the Cutting lemma and the Kővári-Sós-Turán theorem.

\begin{proof}[Aliter for \cref{thm:szemeredi-trotter}]
	Let $P$ be the set of $n$ points and $L$ be the set of $n$ lines in $\R^2$. We need to show that there are at most $O(n^{4/3})$ incidences between $P$ and $L$. We apply the cutting lemma with $r = n^{1/3}$, which divides the plane into $t = O(n^{2/3})$ generalized triangles $\Delta_1, \Delta_2, \ldots, \Delta_t$. 
	
	Let $V$ be the points that lie on the vertex of some $\Delta_i$. Since $|V| \leq 3t = O(n^{2/3})$, \cref{cor:ks} gives us $|I(V, L)| = O(n^{2/3}\sqrt{n} + n^{2/3}) = O(n^{4/3})$.

	Let $|L'|$ be the set of lines that borders some triangle $\Delta_i$. Then $|L'| \leq 3t = O(n^{2/3})$, and \cref{cor:ks} again gives us $|I(P_0, L')| = O(n^{2/3}\sqrt{n} + n^{2/3}) = O(n^{4/3})$.

	It remains to count the incidences that occur at the interior of some triangle. Let $P_i$ be the set of points in $P$ that lies in the interior of $\Delta_i$. Let $L_i$ be the set of lines intersecting the interior of $\Delta_i$. By the cutting lemma, $|L_i| \leq n/r = O(n^{2/3})$. Hence,
	\[
		\sum_{i = 1}^t I(P_i, L_i) \leq \sum_{i = 1}^t I(P_i, n^{2/3}) = \sum_{i = 1}^t O(|P_i|n^{1/3} + n^{2/3}) = O(n^{4/3}).
	\]
\end{proof}

\newpage

\section{Beck's Theorem}

\begin{theorem}[Beck's Theorem]
	Given a set of $n$ points $P$, there exists $\epsilon \in (0, 1)$ such that either $P$ contains $\epsilon n$ points on a line or $P$ generates at least $\epsilon n^2$ distinct lines.
\end{theorem}

\begin{proof}
	We may assume $n$ is large, otherwise we the problem is trivial. Let $P$ be a set of $n$ points in $\R^2$. For $b > a \geq 2$, let $L_{[a, b]}$ be the set of lines generated by $P$ with least $a$ but less than $b$ points on it. By \cref{cor:szemeredi-trotter}, $L_{[a, b]} = O(n^2/a^3)$. We first make the following two observations:
	
	For $k \leq \sqrt{n}$,
	\[
		\#\{\{p_1, p_2\} : p_1, p_2 \in l, \, l \in L_{[k, \sqrt{n}]}\} \leq \sum_{i = 0}^{\log_2 \frac{\sqrt{n}}{k}} |L_{[2^ik, 2^{i + 1}k]}|\binom{2^{i + 1}k}{2} = \sum_{i = 0}^{\log_2 \frac{\sqrt{n}}{k}} O(n^2/2^{i}k) = O(n^2/k).
	\]
	Hence, for $k < \sqrt{n}$, there are $O(n^2/k)$ pair of points in $P$ that lies on a line with at least $k$ but at most $\sqrt{n}$ points. 
	
	For $K > \sqrt{n}$, 
	\[
		\#\{\{p_1, p_2\} : p_1, p_2 \in l, \, l \in L_{[\sqrt{n}, K]}\} \leq \sum_{i = 0}^{\log_2 \frac{K}{\sqrt{n}}} |L_{[2^i\sqrt{n}, 2^{i + 1}\sqrt{n}]}|\binom{2^{i + 1}\sqrt{n}}{2} = \sum_{i = 0}^{\log_2 \frac{K}{\sqrt{n}}} O(2^in^{3/2}) = O(Kn).
	\]
	Hence, there are $O(Kn)$ pairs of points from $P$ that lies on a line with at least $\sqrt{n}$ but at most $K$ points.

	We now prove the theorem. Let $\epsilon \in (0, 1)$ and set $\epsilon' = 4\sqrt{\epsilon}$. Assume that no $\epsilon' n$ points in $P$ are colinear. Let $K = \epsilon'n$ and note that $K > \sqrt{n}$. Then the number of pairs of points in $P$ that lies on a line with at least $\sqrt{n}$ but at most $K$ points is $O(Kn) \leq c\epsilon' n^2 \leq n^2/10$, for some constant $c$ and suffciently small $\epsilon$. Now let $k = 1/\epsilon'$ and note that $k \leq \sqrt{n}$. Then the number of pairs of points in $P$ that lies on a line with at least $k$ but at most $\sqrt{n}$ points is $O(n^2/k) \leq c'\epsilon' n^2 \leq n^2/10$, for some constant $c'$ and $\epsilon$ suffciently small. But then the number of pairs of points in $P$ that lies in a $k$-rich line is at most $n^2/10 + n^2/10 = n^2/5$. Thus there are at least $\binom{n}{2} - n^2/5 \geq n^2/4$ pairs in $P$ that lies on a line with at most $k$ points, and so there are at least $\frac{n^2/4}{\binom{k}{2}} \geq \epsilon m^2$ distinct lines generated by $P$.
\end{proof}

\newpage

\section{Simplicial Partition}

\begin{theorem}[Simplicial Partition]
	Let $P$ be $n$ points in $\R^2$. There exists partition $P = P_1 \sqcup P_2 \sqcup \cdots \sqcup P_{2r}$ and generalized triangles $\Delta_1, \Delta_2, \ldots, \Delta_{2r}$, with $P_i \subset \Delta_i$, $|P_i| = n/2r$ for $i < 2r$ and $|P_{2r}| \leq n/2r$, such that for any line $l$ generated by $P$, $l$ will cross the interior of $O(\sqrt{r})$ number of $\Delta_i$'s.
\end{theorem}

\begin{proof}
	Pick $r > (\log n)^2$. Let $L$ be the set of lines generated by $P$. Let $\Delta'_1 \cup \Delta'_2 \cup \cdots \cup \Delta'_r$ be the generalized trianges yielded by the cutting lemma on $L$ with parameter $t = r$. By the pigeonhole principle, there exists $\Delta_i$ that contains $\geq n/r$ points from $P$. Let $P_1$ be some $n/2r$ points selected from $\Delta_i$ excluding the corners, and let $\Delta_1 = \Delta'_i$. Set $P' = P \backslash P_1$. For each line that crosses the interior of $\Delta_1$, we double it by creating a copy of the line close to it, and let $L'$ be all the lines after this process. Note that by the cutting lemma, the number of lines that cross the interior of $\Delta_1$ is $c|L|/\sqrt{r}$ for some $c > 0$, and so
	\[
		|L'| \leq |L| + \frac{c|L|}{\sqrt{r}} = \left(1 + \frac{c}{\sqrt{r}}\right)|L|.
	\]
	Now apply the cutting lemma again to $L'$ with parameter $t = r(1 - 1/2r)$, and we get a generalized triangle $\Delta_i''$ wtih $\geq |P'|/t = \frac{|P'|}{r(1 - 1/2r)} = n/r$ points from $P'$ that lies in $\Delta_i''$. Set $P_2$ be some $n/2r$ points of $P'$ in $\Delta_i''$ excluding the corners, and let $\Delta_2 = \Delta_i''$. Set $P'' = P' \backslash P_2$ and note taht $|P''| = (1 - 1/r)n$. For any line that crosses the interior of $\Delta_2$, we double again it, and let $L''$ be all the lines after this process. By the same argument, 
	\[
		|L''| \leq |L'| + \frac{c|L'|}{\sqrt{r(1 - 1/2r)}} = \left(1 + \frac{c}{\sqrt{r(1 - 1/2r)}}\right)|L'| \leq \left(1 + \frac{c}{\sqrt{r}}\right)\left(1 + \frac{c}{\sqrt{r(1 - 1/2r)}}\right)|L|.
	\]
	Repeat the above process, and after $k$ iterations we get point sets $P_1, P_2, \ldots, P_k$ and generalized triangles $\Delta_1, \Delta_2, \ldots, \Delta_k$. Set $P^{(k)} = P\backslash(P_1 \cup P_2 \cup \cdots \cup P_k)$. Again, let $L^{(k)}$ be the set of lines after doubling the lines that cross the interior of some $\Delta^{(k)}_i$'s. Then
	\[
		|P^{(k)}| = |P| - \frac{kn}{2r} = \left(1 - \frac{k}{2r}\right)n.
	\]
	\[
		|L^{(k)}| \leq \left(1 + \frac{c}{\sqrt{r}}\right)\left(1 + \frac{c}{\sqrt{r - 1/2}}\right) \cdots \left(1 + \frac{c}{\sqrt{r - (k - 1)/2}}\right)|L| \leq |L|\exp\left(c\sum_{j = 0}^{2r - 1} \frac{1}{\sqrt{r - j/2}}\right).
	\]
	Iterate this process until there are $< n/2r$ points left, and let $P_{2r}$ be the remaining points and $\Delta_{2r}$ be some generalized triangle that contains $P_{2r}$.

	It remains to show that any line $l \in L$ crosses the interior of $O(\sqrt{r})$ $\Delta_i$'s. Let $x$ be the number of $\Delta_i$'s that some line $l$ crosses. Notice that by the end of the process above,
	\[
		2^x \leq \#\text{copies of $l$} \leq |L^{(2r)}| \leq |L|\exp\left(c\sum_{j = 0}^{2r - 1} \frac{1}{\sqrt{r - j/2}}\right) \leq n^2e^{O(\sqrt{r})} = 2^{O(\sqrt{r})}.
	\]
	This proves the theorem.
\end{proof}

\newpage

\section{Triangle Removal Lemma}

\begin{definition}
	The \textit{density} of edges between two vertex sets $A$ and $B$ is 
	\[
		d(A, B) \coloneq \frac{|E(A, B)|}{|A||B|}.
	\]
\end{definition}

\begin{definition}
	Let $\epsilon \in (0, 1)$. The pair of vertex sets $(A, B)$ is \textit{$\epsilon$-regular} if for all $A' \leq A$ and $B' \leq B$ such that $|A'| \geq \epsilon |A|$ and $|B'| \geq \epsilon |B|$, we have
	\[
		|d(A', B') - d(A, B)| \leq \epsilon.
	\]
\end{definition}

\begin{definition}
	Given a graph $G = (V, E)$, a partition $V = V_1 \sqcup V_2 \sqcup \cdots \sqcup V_k$ is a \textit{$\epsilon$-regular} if 
	\[
		\sum_{(i, j) \in [k]^2, \, (V_i, V_j) \text{ not $\epsilon$-regular}} |V_i||V_j| \leq \epsilon |V|^2.
	\]
\end{definition}

Note that we are only interested in dense graphs. This is because if $|E(A, B)| = o(|A||B|)$, the density of $0$ and so the pair $(A, B)$ is trivially $\epsilon$-regular.

\begin{theorem}[Szemerédi's Regularity Lemma]
	For all $\epsilon > 0$, there exists $k = k(\epsilon)$ such that for any graph $G = (V, E)$, there exists an $\epsilon$-regular partition $V = V_1 \sqcup \cdots \sqcup V_k$.
\end{theorem}

\begin{lemma}[Counting Lemma]
	Let $G = (V, E)$ be a graph, such that $V$ is partitioned into $X \sqcup Y \sqcup Z$ where each pair of them are $\epsilon$-regular, and $d(X, Y) = \alpha, d(X, Z) = \beta, d(Y, Z) = \gamma$, with $\alpha, \beta, \gamma > 2\epsilon$. Then
	\[
		\#\{K_3 \subseteq G\} \geq (1 - 2\epsilon)(\alpha - \epsilon)(\beta - \epsilon)(\gamma - \epsilon)|X||Y||Z|.
	\]
\end{lemma}

\begin{proof}
	For $x \in X$, denote $d_Y(x) = d(x) \cap Y$ and $d_Z(x) = d(x) \cap Z$. We claim that $d_Y(x) < (\alpha - \epsilon)|Y|$ for at most $\epsilon|X|$ vertices in $X$. Suppose otherwise. Let $X' \subseteq X$ be the set of vertices with $d_Y(x) < (\alpha - \epsilon)|Y|$. Since $(X, Y)$ is $\epsilon$-regular, $|d(X', Y) - d(X, Y)| \leq \epsilon$, and so
	\[
		\alpha - \epsilon < d(X', Y) = \frac{|E(X', Y)|}{|X'||Y|} \leq \frac{(\alpha - \epsilon)|X'||Y|}{|X'||Y|} = \alpha - \epsilon.
	\]
	This contradiction proves the claim. By the same argument, we also know that $d_Z(x) < (\gamma - \epsilon)|Y|$ for at most $\epsilon|X|$ vertices in $X$.

	Let $x \in X$ with $d_Y(x) \geq (\alpha - \epsilon)|Y|$ and $d_Z(x) \geq (\gamma - \epsilon)|Z|$. Let $|Y'| = N(x) \cap Y$ and $|Z'| = N(x) \cap Z$. Then
	\[
		\#\{K_3 \subseteq G, x \in K_3\} = |E(Y', Z')|.
	\]
	Since $|d(Y', Z') - d(Y, Z)| < \epsilon$, we have 
	\[
		\beta - \epsilon < d(Y', Z') = \frac{|E(Y', Z')|}{|Y'||Z'|}.
	\]
	Rearranging gives us
	\[
		\#\{K_3 \subseteq G, x \in K_3\} = \geq (\beta - \epsilon)|Y'||Z'| \geq (\beta - \epsilon)(\alpha - \epsilon)(\gamma - \epsilon)|Y||Z|.
	\]
	Since there are at least $(1 - 2\epsilon)$ such $x$'s in $X$,
	\[
		\#\{K_3 \subseteq G\} \geq (1 - 2\epsilon)(\alpha - \epsilon)(\beta - \epsilon)(\gamma - \epsilon)|X||Y||Z|.
	\]
\end{proof}

\newpage

\section{Roth's Theorem}

\begin{theorem}[Roth's Theorem]
	For all $\delta \in (0, 1)$, there exists $n_0$ such that for all $n > n_0$, any subset of $[n]$ of size $\geq \delta n$ contains a 3-term arithmetic progression.
\end{theorem}

\newpage

\section{Solymosi's Theorem}

\begin{theorem}
	Let $P$ be a set of $n$ points and $L$ be a set of $n$ lines in $\R^2$, and let $r$ be a parameter. If the arrangement of $P$ and $L$ does not contain a triangle, then $|I(P, L)| = O(n^{4/3}/\log^* n) = o(n^{4/3})$, where $\log^*$ is the iterated logarithm. 
\end{theorem}

\end{document}